<mat-card fxFlex fxLayout="column" fxLayoutGap="0.5em" class="margin-5">
    <mat-card *ngIf="!dismissInfo" fxLayout="row" fxLayout.xs="column" fxLayoutGap="0.5em" fxLayoutAlign="center center" class="theme-background">
        <label style="line-height: 1.5em; font-size: 1.1em;"><b>This is a project by <a href="https://twitter.com/nixerFFM" rel="noreferrer" target="_blank">nixerFFM</a></b> (not affiliated to XUMM but with permission & endorsed by <a href="https://twitter.com/XRPLLabs" rel="noreferrer" target="_blank">XRPL Labs</a>, the creators of XUMM), using the XUMM signing platform.</label>
        <button mat-raised-button color="primary" matTooltip="Got it!" matTooltipPosition="above" (click)="gotIt()">Got it!</button>
    </mat-card>
    <div fxLayout="row" fxLayout.xs="column">
        <div *ngIf="xrplAccount" style="align-self: start;">
            <button mat-raised-button color="primary" matTooltip="Logout" matTooltipPosition="below" (click)="logoutAccount()">
                Logout
            </button>
        </div>
        <div fxLayout="column" fxLayoutAlign="start center" class="floatcenter">
            <div *ngIf="!xrplAccount">
                <button mat-raised-button class="theme-background" style="height: 50px; border-radius: 12px; padding: 5px 5px 5px 5px;" matTooltip="Login with XUMM to load your account data." matTooltipPosition="right" (click)="openSignInDialog()">
                    <img src="../../assets/xummSignIn.svg" style="width: 230px; height: 40px;"  alt="Login with XUMM">
                </button>
            </div>
            <div style="padding-top: 0.5em;" class="floatcenter">
                <div *ngIf="!xrplAccount" fxLayout="column" fxLayout.gt-md="row" fxLayoutGap="0.5em">
                    <label class="loading">Please sign in so we can check some things and to access the transactions.</label>
                </div>
                
                <div *ngIf="xrplAccount" fxLayout="column" fxLayout.gt-md="row" fxLayoutGap="0.5em">
                    <label fxHide.xs>Logged in with:</label>
                    <label class="loading" ngStyle.xs="font-size: 0.8em;"> {{xrplAccount}}</label>
                    <label fxHide.xs>Balance:</label>
                    <label class="loading" ngStyle.xs="font-size: 0.8em;">{{getAccountBalance()}} XRP.</label>
                    <label class="warning" ngStyle.xs="font-size: 0.8em;">(Available: {{getAvailableBalance()}} XRP.)</label>
                    <label>&nbsp;</label>
                </div>                
                <label class="warning" ngStyle.xs="font-size: 0.8em;" *ngIf="!loadingData && xrplAccount && xrplAccount_Info && xrplAccount_Info.error">This account was not found on the node {{selectedNodeUrl}}.</label>
                <div fxLayout="row" fxLayoutAlign="center center" *ngIf="loadingData">
                    <label class="loading" ngStyle.xs="font-size: 0.8em;" >Loading account data...</label>
                    <mat-progress-spinner color="primary" mode="indeterminate" diameter=20></mat-progress-spinner>
                </div>
                <div fxLayout="row" fxLayoutAlign="center center" *ngIf="cannotConnectToNode">
                    <label class="warning" ngStyle.xs="font-size: 0.8em;" >Cannot connect to the XRP Ledger! Check your internet connection!</label>
                </div>
                <div>
                    <label>&nbsp;</label>
                </div>
                <mat-card class="theme-background" *ngIf="xrplAccount && !nodesAreSame && xrplAccount_Info && !cannotConnectToNode" fxLayout="column" fxLayoutGap="0.5em">
                    <label class="success">Your XUMM app is connected to: {{xummNodeUrl}}</label>
                    <label class="warning">But transactions will be submitted to: <b>{{selectedNodeUrl}}</b></label>
                </mat-card>
            </div>
        </div>
        <mat-card class="theme-background" fxShow fxHide.xs >
            <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1em">
                <label class="loading">XRPL Network Selector</label>
                <mat-select [(ngModel)]="selectedNode" (selectionChange)="networkChanged()" [disabled]="loadingData">
                    <mat-option *ngFor="let network of availableNetworks" [value]="network.value">
                        {{network.viewValue}} - {{network.value}}
                    </mat-option>
                </mat-select>
                <div *ngIf="selectedNode === 'custom'" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.3em">
                    <form fxLayout="column" fxLayoutGap="0.5em" style="padding-bottom: 1em;padding-top: 1em;">
                        <mat-form-field>
                          <input #inpcustomnode matInput type="url" name="customnode" matInput placeholder="Custom Node" [(ngModel)]="customNodeInput" (ngModelChange)="checkUrlChange()" [disabled]="loadingData">
                          <mat-hint *ngIf="customNodeInput && customNodeInput.length > 4 && !validCustomNodeUrl">Not a valid node url. Has to start with 'ws' or 'wss'</mat-hint>
                        </mat-form-field>
                    </form>
                    <div>
                        <button mat-raised-button color="primary" matTooltip="Connect" matTooltipPosition="below" (click)="connectCustomNetwork()" [disabled]="!validCustomNodeUrl || loadingData">
                            Connect
                        </button>
                    </div>
                </div>
            </div>
        </mat-card>
    </div>
    <mat-card fxShow.xs fxHide class="theme-background floatcenter" style="font-size: 0.8em;">
        <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1em">
            <label class="loading">XRPL Network Selector</label>
            <mat-select [(ngModel)]="selectedNode" (selectionChange)="networkChanged()" [disabled]="loadingData">
                <mat-option *ngFor="let network of availableNetworks" [value]="network.value">
                    {{network.viewValue}} - {{network.value}}
                </mat-option>
            </mat-select>
            <div *ngIf="selectedNode === 'custom'" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.3em">
                <form fxLayout="column" fxLayoutGap="0.5em" style="padding-bottom: 1em;padding-top: 1em;">
                    <mat-form-field>
                      <input #inpcustomnode matInput type="url" name="customnode" matInput placeholder="Custom Node" [(ngModel)]="customNodeInput" (ngModelChange)="checkUrlChange()" [disabled]="loadingData">
                      <mat-hint *ngIf="customNodeInput && customNodeInput.length > 4 && !validCustomNodeUrl">Not a valid node url. Has to start with 'ws' or 'wss'</mat-hint>
                    </mat-form-field>
                </form>
                <div>
                    <button mat-raised-button color="primary" matTooltip="Connect" matTooltipPosition="below" (click)="connectCustomNetwork()" [disabled]="!validCustomNodeUrl || loadingData">
                        Connect
                    </button>
                </div>
            </div>
        </div>
    </mat-card>
    <div *ngIf="lasTrxLink" style="padding-top: 1em;">
        View your transaction on the Ledger: <br fxHide fxShow.xs>
        <span><a [href]="lasTrxLink" target="_blank;" rel="noreferrer">xrpl.org Explorer</a></span>
    </div>
    <mat-accordion fxLayout="column" fxLayoutGap="0.5em" style="padding-top: 0.5em;">
        <accountset [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" (onPayload)="onPayloadReceived($event)"></accountset>
        <escrowcreate [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></escrowcreate>
        <escrowfinish [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></escrowfinish>
        <escrowcancel [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></escrowcancel>
        <setregularkey [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></setregularkey>
        <signerlistset [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></signerlistset>
        <trustset [accountInfoChanged]="accountInfoChanged.asObservable()" [accountObjectsChanged]="accountObjectsChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></trustset>
        <accountdelete [accountInfoChanged]="accountInfoChanged.asObservable()" [transactionSuccessfull]="transactionSuccessfull.asObservable()" (onPayload)="onPayloadReceived($event)"></accountdelete>
    </mat-accordion>
</mat-card>
